<!DOCTYPE html>
<html>
    <head>
        <title>Qeo Native Documentation : C Porting Information</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Qeo Native Documentation</a></span>
                            </li>
                                                    <li>
                                <span><a href="Customer-Documentation-Space-Home_21675984.html">Customer Documentation Space Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Platform-Integration-Documents_21675985.html">Platform Integration Documents</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Qeo Native Documentation : C Porting Information
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
    
            Created by <span class='author'> lissensj</span> on May 21, 2014
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h4 id="CPortingInformation-PrerequisitesforC">Prerequisites for C</h4><p>We provide a Qeo C library and associated header files. In practice this means you have to include the <em>qeo/api.h</em> header file in your sources and link your application against the<em> libqeo.so</em> library. These files are located in the <em>c/include</em> and <em>c/lib</em> folders of the Qeo SDK respectively.</p><h4 id="CPortingInformation-Dependencies">Dependencies</h4><p>The Qeo library depends on other libraries that are mentioned below. The Qeo SDK comes with binaries of these libraries but you can replace them with your own versions if you want.</p><ul><li><p><strong>OpenSSL</strong>:  The Qeo SDK has been tested with OpenSSL v1.0.1e. For more information, click <a href="http://www.openssl.org/" class="external-link" rel="nofollow">here</a>.</p></li><li><p><strong>Curl</strong> :  The Qeo SDK has been tested with curl v7.23.1. For more information, click <a href="http://curl.haxx.se/" class="external-link" rel="nofollow">here</a>.</p></li><li><strong>Jansson</strong>: The Qeo SDK has been tested with jansson v2.4. For more information, click <a href="http://www.digip.org/jansson/" class="external-link" rel="nofollow">here</a>.</li></ul><h4 id="CPortingInformation-Introduction">Introduction</h4><p>This document describes how you can port Qeo to your own Linux-based platform. Currently Qeo can only run on *nix-based platforms. However, depending on your platform specifications, the basic implementation as provided with the SDK might not suffice. Therefore, we leave you with the choice of making your own implementation of the Qeo Platform API.</p><p>To port Qeo to another platform, there are two main parts that have to be considered by the platform integrator:</p><ul><li><p>OpenSSL engine  (currently implementing your own OpenSSL engine is not supported, the SDK comes with a default pkcs12-based engine implementation)</p></li><li><p>Qeo Platform API  (aka qeo-c-util)</p></li></ul><h4 id="CPortingInformation-Qeoplatform">Qeo platform</h4><p>In order to use Qeo on any platform, we have created a dedicated set of APIs that a platform integrator has to implement. For example, the path where you want Qeo to store its credentials, is likely to be platform dependent. Also, the manner through which the user is prompted for the OTC could be of interest to the platform integrator.</p><p>The Qeo-core logic will call a set of API's which can be found in <em>$QEO_HOME/c/platform/include/qeo</em>. The platform implementer can opt to implement these functions directly. Alternatively, there is an API to which callbacks can be registered at run-time and which also shields some of the implementation complexity of the functions of <em>$QEO_HOME/c/platform/include/qeo</em>. This helper API can be found in <em>$QEO_HOME/c/platform/include/platform_api</em>. Platform integrators are encouraged to use the latter.</p><p>By default, the Qeo SDK is shipped with a pre-compiled libqeoutil.so (e.g. in <em> $QEO_HOME/c/lib/i686-linux</em> ) which is based on the default implementation found under <em>$QEO_HOME/c/platform/src/qeo</em>. This<em> libqeoutil.s</em>o can be built (for a Linux platform) by running the <em>$QEO_HOME/c/platform/script/build.sh</em> script. As you develop your own platform porting code, you can modify that script to your needs but the resulting .so file must always be named<em> libqeoutil.so</em>.</p><h5 id="CPortingInformation-$QEO_HOME/c/platform/include/platform_api">$QEO_HOME/c/platform/include/platform_api</h5><ul><li><strong>platform_common.h:</strong> Common helper functions.</li><li><strong>platform_api.h:</strong> Helper API which can be used by platform integrator to facilitate integration effort (rather than implementing the functions from <em>$QEO_HOME/c/platform//include/qeo</em>). The main benefit is it allows registration of callbacks at run-time. More information can be found at <strong><a href="Qeo-Platform-Security_21675987.html">Qeo Platform Security</a></strong>.</li></ul><h5 id="CPortingInformation-$QEO_HOME/c/platform/include/qeo">$QEO_HOME/c/platform/include/qeo</h5><p><img class="emoticon emoticon-warning" src="images/icons/emoticons/warning.png" data-emoticon-name="warning" alt="(warning)"/> As a platform implementer, you are encouraged to have a look at the header files in <em>$QEO_HOME/c/platform/include/platform_api</em> first.</p><p>A platform integrator can also choose to directly implement the functions called by Qeo core logic. </p><ul><li><p><strong>Logging (log.h):</strong></p><p>Qeo uses four logging macros. You can provide your own implementation of this logging functionality. For instance, you may want to send Qeo logging to a syslog daemon.</p></li><li><p><strong>Device-info (device.h):</strong></p><p>The qeo_platform_device_info structure is a collection of device-specific information such as a Qeo Device UUID, manufacturer, model name, etc. The default Linux implementation uses the uname() system call to populate that structure. You can provide your own implementation which for instance can use the udev library to populate the structure but this would only work on an x86 architecture.</p></li><li><p><strong>platform.h:</strong> </p><p>Getting a storage path which is used by Qeo to keep certain files.</p><p>qeo_platform_get_device_storage_path() builds a full path based on a supplied file_name.</p></li><li><p><strong>Security-related API (platform_security.h):<br /><span style="line-height: 13.0pt;font-size: 10.0pt;font-weight: normal;">A set of functions related to Qeo security, to be more specific the registration of devices. For more details please refer to the </span><a href="Qeo-Platform-Security_21675987.html">Qeo Platform Security</a><span style="line-height: 13.0pt;font-size: 10.0pt;font-weight: normal;"> </span><span style="line-height: 13.0pt;font-size: 10.0pt;font-weight: normal;">section.</span></strong></p><p> </p></li></ul><h5 id="CPortingInformation-$QEO_HOME/c/platform/src/qeo/"><strong>$QEO_HOME/c/platform/src/qeo/</strong></h5><ul><li><strong>common.c:</strong> implements functions from platform_common.h</li><li><strong>default_impl.c:</strong> default platform implementation registering callbacks for Linux using platform_api.h. Have a look at this file when you are creating a new platform implementation.</li><li><strong>linux_default_device.c:</strong> part of default platform implementation. Have a look at this file when you are creating a new platform implementation.</li><li><strong>platform.c:</strong> implements functions from <em>$QEO_HOME/c/platform/include/qeo</em>. Generally, you don't need to change this file.</li><li><strong>qeo_log.c:</strong> logging functions</li></ul><p> </p>    <div class="aui-message warning shadowed information-macro">
                            <span class="aui-icon icon-warning">Icon</span>
                <div class="message-content">
                            <p><span style="color: rgb(0,0,0);">It is not necessary to re-create everything, since for most scenarios the default implementation will likely suffice. Also, Qeo is automatically  adapted to any networking interfaces present on the Linux device.</span></p>
                    </div>
    </div>
<h4 id="CPortingInformation-Caveats">Caveats</h4><p>In order to prevent concurrent Qeo registration (for the same user), a locking mechanism is in place to ensure only one Qeo application registers at a given moment in time. This mechanism makes use of a lock file which is located<em> /tmp/.qeo_reg_UID.lock</em> where UID will be replaced by the uid of the user. In other words, native Qeo applications depend on the presence of a writable <em>/tmp</em> directory.</p><h4 id="CPortingInformation-DateandTimeSetting">Date and Time Setting</h4><p>Certificates contain a date and time stamp. Make sure the date and time settings of your device are correct. If there is a discrepancy, the certificate may not be perceived as valid.</p>
                    </div>

                    
                 
                </div>             </div> 
            <div id="footer">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 21, 2014 08:21</p>
                </section>
            </div>
        </div>     </body>
</html>
